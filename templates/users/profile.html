{%extends 'base/base.html' %}
{% load static %}

{% block 'styles' %}
<link rel="stylesheet" href="{% static 'style/style-profile.css' %}">
{% endblock %}

{%block 'content'%}

<div id="image-preview-container">
  <img src="" alt="Image Preview" class="image-preview" id="image-preview">
  <div class="btn-group">
    <button class="btn btn-outline-dark" style="color: white !important;" onclick="cancelPreview()">Cancelar</button>
    <button class="btn btn-dark" onclick="savePreview()">Salvar</button>
  </div>
</div>

<section>
  <div class="container py-5">
    <div class="row">
      <div class="col-lg-4">
        <div class="card mt-card-mobile mb-4">
          <div class="card-body text-center card-user">

            <div class="image-container position-relative d-flex justify-content-center align-items-center">
              {% include "components/user_avatar.html" with user=user size=150 class="img-fluid profile-pic" %}
            </div>

            <h5 class="my-3">{{ user.username }}</h5>
            <div class="d-flex justify-content-center mb-2">
              <a href="{% url 'users:edit_user' user.id %}" type="button" class="btn btn-outline-dark ms-1">Editar
                informações pessoais</a>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-8">
        <div class="card mb-4">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Nome Completo</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ user.first_name|default:"--" }} {{ user.last_name|default:"--" }}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Email</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ user.email|default:"--" }}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Rede Social</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ user.personaldata.social_network|default:"--" }}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Data de Nascimento</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ user.personaldata.date_of_birth|date:"d/m/Y"|default:"--" }}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">RG</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ user.personaldata.rg|default:"--" }}</p>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-sm-3">
                <p class="mb-0">Identificação</p>
              </div>
              <div class="col-sm-9">
                <p class="text-muted mb-0">{{ user.personaldata.bond_choice|default:"--" }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div>
      {% if enrollments %}
      <h3 class="topic-color text-center mt-5">Inscrições</h3>

      <div class="row">
        {% for enrollment in enrollments %}
        <div class="col-md-6 mt-3">
          <div class="card mb-4 mb-md-0">
            <div class="card-body">
              <p class="mb-2 topic-color fs-5">{{ enrollment.event.name }}</p>

              {% if enrollment.event.banner_image %}
              <img src="{{ enrollment.event.banner_image.url }}" class="post-user w-100" alt="Banner do Evento">
              {% else %}
              <img src="{% static 'images/images-cities/charqueadas-trevo.jpeg' %}" class="post-user w-100"
                alt="Imagem padrão">
              {% endif %}

              <p class="mt-3 mb-1 fs-6">
                <span class="fw-bolder">Local:</span> {{ enrollment.route.departure_location }}
              </p>

              <p class="mt-3 mb-1 fs-6">
                <span class="fw-bolder">Início do Evento:</span> {{ enrollment.route.concentration }}
              </p>

              <p class="mt-3 mb-1 fs-6">
                <span class="fw-bolder">Nome do inscrito:</span> {{ user.first_name }}
              </p>

              <a href="{% url 'events:event' pk=enrollment.event.id %}" class="btn btn-outline-secondary w-100">
                Acompanhar Evento
              </a>

              <a href="{% url 'events:delete_enrollment' enrollment_id=enrollment.id %}"
                class="btn btn-outline-secondary w-100 mt-1">
                Cancelar Inscrição
              </a>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>

      {% else %}

      <div class="d-flex flex-column align-items-center text-center mt-4 py-4">

        <h4 class="fw-bold text-muted mb-2">Você ainda não participou de nenhum evento</h4>

        <p class="text-muted mb-3">
          Quando você se inscrever em um evento, ele aparecerá aqui.
        </p>

        <a href="/#events" class="btn-secondary-cric-bold btn-cric px-4 py-2">
          Ver Eventos Disponíveis
        </a>

      </div>


      {% endif %}
    </div>
  </div>
</section>

<script src="{% static 'js/users/profile.js' %}" async></script>

{%endblock%}